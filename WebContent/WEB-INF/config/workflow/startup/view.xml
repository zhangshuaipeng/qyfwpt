<?xml version="1.0" encoding="UTF-8"?>
<model.view.ViewModel>
  <system>workflow</system>
  <code>startup</code>
  <name>流程启动</name>
  <flow>N</flow>
  <visible>Y</visible>
  <pages>
    <model.view.PageModel>
      <code>list</code>
      <name>流程列表</name>
      <fields>
        <model.view.FieldModel>
          <code>subtab</code>
          <name>列表</name>
          <ctrltype>GRID</ctrltype>
          <dict>tab</dict>
        </model.view.FieldModel>
      </fields>
    </model.view.PageModel>
    <model.view.PageModel>
      <code>startup</code>
      <name>启动流程</name>
      <fields>
        <model.view.FieldModel>
          <code>flowcode</code>
          <name>流程号</name>
          <ctrltype>OPTION</ctrltype>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>title</code>
          <name>工作名称</name>
          <datatype>STRING</datatype>
          <required>Y</required>
          <ctrltype>TEXT</ctrltype>
          <length>255</length>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>msgsend</code>
          <name>消息通知方式</name>
          <datatype>STRING</datatype>
          <ctrltype>CHECKBOX</ctrltype>
          <dict>msgtype</dict>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>enablenav</code>
          <name>是否开启输入工作标题导航页面</name>
          <ctrltype>HIDDEN</ctrltype>
          <defaults>true</defaults>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>orgcode</code>
          <name>组织号</name>
          <ctrltype>HIDDEN</ctrltype>
          <defaults>{ORGCODE}</defaults>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>params</code>
          <name>流程启动的初始参数</name>
          <ctrltype>HIDDEN</ctrltype>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>canvas</code>
          <name>流程图</name>
          <ctrltype>JSPPAGE</ctrltype>
          <width>700</width>
          <height>600</height>
          <dict>canvas.jsp</dict>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>instanceid</code>
          <name>流程实例号</name>
          <ctrltype>HIDDEN</ctrltype>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>wid</code>
          <name>工作实例</name>
          <ctrltype>HIDDEN</ctrltype>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>debug</code>
          <name>调试状态</name>
          <ctrltype>OPTION</ctrltype>
        </model.view.FieldModel>
      </fields>
      <actions>
        <model.view.ActionModel>
          <code>startup</code>
          <name>启动流程</name>
          <type>CUSTOM</type>
          <showtype>BUTTON</showtype>
          <href>startup</href>
          <display>ICONTEXT</display>
          <operand>FREE</operand>
          <icon>save.png</icon>
          <target>_self</target>
        </model.view.ActionModel>
        <model.view.ActionModel>
          <code>exit</code>
          <name>返回</name>
          <type>URL</type>
          <showtype>BUTTON</showtype>
          <url>startup.cmd?$ACTION=flows</url>
          <display>ICONTEXT</display>
          <operand>FREE</operand>
          <icon>exit.gif</icon>
          <target>_self</target>
        </model.view.ActionModel>
      </actions>
    </model.view.PageModel>
    <model.view.PageModel>
      <code>dispatch</code>
      <name>跳转页面</name>
      <fields>
        <model.view.FieldModel>
          <code>instanceid</code>
          <name>流程实例号</name>
          <ctrltype>HIDDEN</ctrltype>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>wid</code>
          <name>工作实例号</name>
          <ctrltype>HIDDEN</ctrltype>
        </model.view.FieldModel>
      </fields>
    </model.view.PageModel>
    <model.view.PageModel>
      <code>flows</code>
      <name>流程启动</name>
      <fields>
        <model.view.FieldModel>
          <code>flowtype</code>
          <name>流程类型</name>
          <ctrltype>HIDDEN</ctrltype>
        </model.view.FieldModel>
        <model.view.FieldModel>
          <code>flows</code>
          <name>流程列表</name>
          <ctrltype>JSPPAGE</ctrltype>
          <dict>flows.jsp</dict>
        </model.view.FieldModel>
      </fields>
    </model.view.PageModel>
  </pages>
  <templets>
    <model.view.TempletModel>
      <templet>list</templet>
      <templetname>流程列表</templetname>
      <page>list</page>
      <cols>0</cols>
      <style>list</style>
      <html5>Y</html5>
    </model.view.TempletModel>
    <model.view.TempletModel>
      <templet>startup</templet>
      <templetname>启动流程</templetname>
      <page>startup</page>
      <cols>2</cols>
      <style>form</style>
      <width>720</width>
      <jsfile>&lt;style type=&quot;text/css&quot; media=&quot;screen&quot;&gt; &#xd;
			html, body	{ height:100%; }&#xd;
			body { margin:0; padding:0; overflow:auto; text-align:center; &#xd;
			       background-color: #ffffff; }   &#xd;
			#flashContent { display:none; }&#xd;
        &lt;/style&gt;&#xd;
		&#xd;
		&lt;!-- Enable Browser History by replacing useBrowserHistory tokens with two hyphens --&gt;&#xd;
        &lt;!-- BEGIN Browser History required section --&gt;&#xd;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;../css/history.css&quot; /&gt;&#xd;
        &lt;!-- END Browser History required section --&gt;  &#xd;
        &lt;script type=&quot;text/javascript&quot; src=&quot;history.js&quot;&gt;&lt;/script&gt;&#xd;
        &lt;!-- END Browser History required section --&gt;  &#xd;
		    &#xd;
        &lt;script type=&quot;text/javascript&quot; src=&quot;swfobject.js&quot;&gt;&lt;/script&gt;&#xd;
&lt;script type=&quot;text/javascript&quot; src=&quot;startupchart.js&quot;&gt;&lt;/script&gt;</jsfile>
      <html5>Y</html5>
    </model.view.TempletModel>
    <model.view.TempletModel>
      <templet>dispatch</templet>
      <templetname>跳转页面</templetname>
      <page>dispatch</page>
      <cols>0</cols>
      <style>space</style>
      <jsfile>&lt;script&gt;&#xd;
&#xd;
function formOnLoad() {&#xd;
    var url = &quot;../WorkflowAction.cmd?$WID=&quot; + document.getElementById(&quot;wid&quot;).value;&#xd;
    document.location.href = url;&#xd;
}&#xd;
&#xd;
&lt;/script&gt;</jsfile>
      <html5>Y</html5>
    </model.view.TempletModel>
    <model.view.TempletModel>
      <templet>flows</templet>
      <templetname>流程启动</templetname>
      <page>flows</page>
      <cols>0</cols>
      <style>navspace</style>
      <jsfile>&lt;style&gt;&#xd;
.xingzheng{ height:22px; background:url(&quot;../images/bgbj.gif&quot;) repeat-x; margin:0; font-size:12px; display:block; border-bottom:1px solid #ccc; clear:both;border-top:1px solid #ccc; padding-left:5px; line-height:22px;margin-top:5px;}&#xd;
.xingzheng span{ display:block; padding-right:5px; padding-top:2px; float:left;}&#xd;
.liucheng {float:left;width:240px;list-style:none; padding:10px;font-size:12px;overflow:hidden; display:block;border:solid 1px #ffffff;height:64px;}&#xd;
.liucheng a {&#xd;
font-size:14px;font-weight:bold;&#xd;
}&#xd;
.bg {background-color:#ffffec;border:solid 1px #ebebdc;}&#xd;
.xiaminaneirong{ margin:0; padding:0;}&#xd;
body {overflow:hidden;};&#xd;
&lt;/style&gt;</jsfile>
      <html5>Y</html5>
    </model.view.TempletModel>
  </templets>
  <control>
    <model.view.ControllerModel>
      <action>flows</action>
      <name>选择启动的流程</name>
      <roles>LOGIN</roles>
      <exportpage>flows</exportpage>
      <mode>submit</mode>
      <pull>
        <model.view.HandlerModel>
          <fieldset>SYSTEM</fieldset>
          <business>StartupBo.getMyFlow</business>
          <params>LOGIN</params>
        </model.view.HandlerModel>
      </pull>
    </model.view.ControllerModel>
    <model.view.ControllerModel>
      <action>flow</action>
      <name>流程列表</name>
      <roles>LOGIN</roles>
      <exportpage>list</exportpage>
      <mode>submit</mode>
      <right>
        <entry>
          <string>LOGIN</string>
          <model.view.RightModel>
            <fields>
              <entry>
                <string>subtab</string>
                <string>R</string>
              </entry>
            </fields>
            <actions/>
            <fieldset/>
            <subtable>
              <entry>
                <string>subtab</string>
                <model.view.GridRightModel>
                  <fields>
                    <entry>
                      <string>orgcode</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>flowcode</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>ver</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>type</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>flowname</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>formname</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>pk</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>sysname</string>
                      <string>W</string>
                    </entry>
                    <entry>
                      <string>begin</string>
                      <string>W</string>
                    </entry>
                  </fields>
                  <actions>
                    <entry>
                      <string>begin</string>
                      <string>W</string>
                    </entry>
                  </actions>
                </model.view.GridRightModel>
              </entry>
            </subtable>
          </model.view.RightModel>
        </entry>
      </right>
    </model.view.ControllerModel>
    <model.view.ControllerModel>
      <action>begin</action>
      <name>开始</name>
      <roles>LOGIN</roles>
      <importpage>list</importpage>
      <exportpage>startup</exportpage>
      <mode>submit</mode>
      <pull>
        <model.view.HandlerModel>
          <fieldset>SYSTEM</fieldset>
          <business>StartupBo.beginFlow</business>
          <params>LOGIN,REQ</params>
        </model.view.HandlerModel>
      </pull>
      <enabletransact>Y</enabletransact>
    </model.view.ControllerModel>
    <model.view.ControllerModel>
      <action>startup</action>
      <name>启动流程</name>
      <roles>LOGIN</roles>
      <importpage>startup</importpage>
      <exportpage>dispatch</exportpage>
      <mode>submit</mode>
      <push>
        <model.view.HandlerModel>
          <fieldset>SYSTEM</fieldset>
          <name>主表单</name>
          <business>FlowHandler.createInstance</business>
          <params>flowcode,LOGIN,title,DATA,msgsend,debug</params>
          <retfield>instanceid</retfield>
        </model.view.HandlerModel>
      </push>
      <pull>
        <model.view.HandlerModel>
          <fieldset>SYSTEM</fieldset>
          <name>主表单</name>
          <business>FlowHandler.getLastWork</business>
          <params>instanceid</params>
        </model.view.HandlerModel>
      </pull>
      <enabletransact>Y</enabletransact>
    </model.view.ControllerModel>
    <model.view.ControllerModel>
      <action>chart</action>
      <name>显示流程图</name>
      <roles>LOGIN</roles>
      <exportpage>flows</exportpage>
      <mode>textxml</mode>
      <pull>
        <model.view.HandlerModel>
          <fieldset>SYSTEM</fieldset>
          <name>主表单</name>
          <business>StudioCache.getFlowChart</business>
          <params>orgcode,flowcode,debug</params>
        </model.view.HandlerModel>
      </pull>
    </model.view.ControllerModel>
  </control>
</model.view.ViewModel>